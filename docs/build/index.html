<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Documentation NLS</title><meta name="title" content="Home · Documentation NLS"/><meta property="og:title" content="Home · Documentation NLS"/><meta property="twitter:title" content="Home · Documentation NLS"/><meta name="description" content="Documentation for Documentation NLS."/><meta property="og:description" content="Documentation for Documentation NLS."/><meta property="twitter:description" content="Documentation for Documentation NLS."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Documentation NLS</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Mathematischer-Hintergrund"><span>Mathematischer Hintergrund</span></a></li><li><a class="tocitem" href="#Code-Dokumentation"><span>Code Dokumentation</span></a></li><li><a class="tocitem" href="#Ergebnisse"><span>Ergebnisse</span></a></li><li><a class="tocitem" href="#Visualisierung"><span>Visualisierung</span></a></li><li><a class="tocitem" href="#Transparenz-Hinweis-KI"><span>Transparenz-Hinweis KI</span></a></li><li><a class="tocitem" href="#Referenzen"><span>Referenzen</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NiclRich/NumPrak" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NiclRich/NumPrak/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Dokumentation-Numerikpraktikum"><a class="docs-heading-anchor" href="#Dokumentation-Numerikpraktikum">Dokumentation Numerikpraktikum</a><a id="Dokumentation-Numerikpraktikum-1"></a><a class="docs-heading-anchor-permalink" href="#Dokumentation-Numerikpraktikum" title="Permalink"></a></h1><p>In diesem Julia-Programm wird das in [1] beschriebene Finite-Differenzen Schema implementiert und mit einem expliziten Schema verglichen.</p><p>Die Nichtlinear Schrödingergleichung (NLS) ist eine partielle Differentialgleichung deren Lösung <span>$u(x,t): \mathbb{R} \times \mathbb{R} \to \mathbb{C}$</span> die Gleichung </p><p class="math-container">\[i u_t - u_{xx} + \lambda |u|^2 u = 0 \\
u(x,0) = \phi(x)\]</p><p>erfüllt. Dabei ist <span>$i = \sqrt{-1}$</span> und die Ableitungen sind als Index geschrieben. Dabei ist <span>$\lambda$</span> ein reeler Parameter und <span>$\phi: \mathbb{R} \to \mathbb{R}$</span> eine gegebene Funktion.</p><h2 id="Mathematischer-Hintergrund"><a class="docs-heading-anchor" href="#Mathematischer-Hintergrund">Mathematischer Hintergrund</a><a id="Mathematischer-Hintergrund-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematischer-Hintergrund" title="Permalink"></a></h2><p>Lösungen der NLS erhalten dabei die zwei Größen:</p><p class="math-container">\[\int_{\mathbb{R}} |u|^2 \; dx = const,\\
\int_{\mathbb{R}} \left(\frac{1}{2}|u_{x}|^2 + \frac{\lambda}{4}|u|^4\right)\; dx = const.\]</p><p>In [1] wird ein Finites Differenzenschema angegeben, dass diese beiden Größen erhält und welches implementiert wird. Allerdings wird in diesem Paper nicht die Konvergenz des Schemas gezeigt und numerisch kann dies auch nicht beobachtet werden. Allerdings erhält es die beiden oben genannten Größen.</p><p>Eine Lösung für den Parameter <span>$\lambda = -2$</span> ist zum Testen gegeben mit</p><p class="math-container">\[u(x,t) = \frac{3}{2}\exp\left(i(\frac{5}{4}t - x)\right) sech\left(\frac{3}{2}(x+5) - 3t\right).\]</p><p>Das Schema in [1] wird verglichen mit dem expliziten Schema</p><p class="math-container">\[\frac{i}{\Delta t}(U^{k+1} - U^{k}) - \frac{1}{|\Delta x|^2}AU^k + F_k(U^k) = 0\]</p><p>mit <span>$A$</span> als Finite-Differenzen Matrix für die zweite Ableitung und <span>$U^k$</span> als Approximation im <span>$k$</span>-ten Zeitschritt. Die Funktion <span>$F$</span> ist gegeben durch</p><p class="math-container">\[(F_k(U)))_j = \frac{\lambda}{4}(|U_j|^2 + |U_j^k|^2)(U_j + U_j^k)\]</p><p>mit <span>$j$</span> als Index für den Vektor.</p><h2 id="Code-Dokumentation"><a class="docs-heading-anchor" href="#Code-Dokumentation">Code Dokumentation</a><a id="Code-Dokumentation-1"></a><a class="docs-heading-anchor-permalink" href="#Code-Dokumentation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.NLS.first_conservation-Tuple{Matrix{ComplexF64}}" href="#Main.NLS.first_conservation-Tuple{Matrix{ComplexF64}}"><code>Main.NLS.first_conservation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">first_conservation(U::AbstractMatrix{&lt;:Complex})</code></pre><p>Compute the first conserved quantity of the NLS-equation.</p><p><strong>Description</strong></p><p>This function calculates the <strong>first integral</strong>, the first integral is given by</p><p class="math-container">\[\int |u|^2 \; dx\]</p><p>It assumes:</p><ul><li>Rows of <code>U</code> represent the spatial variable.</li><li>Columns of <code>U</code> represent the temporal variable.</li></ul><p>The function computes:</p><ol><li>The <strong>first integral</strong> as the sum of squared magnitudes (norm) of the solution matrix <code>U</code> for each time step.</li><li>The <strong>maximum</strong> and <strong>minimum</strong> values of the integral across the spatial domain.</li><li>The <strong>dissipation</strong>, defined as the difference between the maximum and minimum values.</li></ol><p><strong>Arguments</strong></p><ul><li><code>U::AbstractMatrix{&lt;:Complex}</code>: A complex-valued matrix where rows represent spatial variables and columns represent temporal variables.</li></ul><p><strong>Returns</strong></p><p>A tuple with the following values:</p><ul><li><code>first_integral::Vector{Float64}</code>: The computed first integral for each time step.</li><li><code>maximal_value::Float64</code>: The maximum value of the first integral.</li><li><code>minimal_value::Float64</code>: The minimum value of the first integral.</li><li><code>dissipation::Float64</code>: The difference between the maximum and minimum values (indicating dissipation).</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Example usage
U = rand(ComplexF64, 100, 10)  # Random complex-valued matrix with 100 spatial points and 10 time steps

first_integral, max_val, min_val, dissipation = first_conservation(U)

println(&quot;First integral: &quot;, first_integral)
println(&quot;Maximum value: &quot;, max_val)
println(&quot;Minimum value: &quot;, min_val)
println(&quot;Dissipation: &quot;, dissipation)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NiclRich/NumPrak/blob/57af75da57fda2b621f1c571d4b3d92c5e4bd305/src/NLS_module.jl#L116-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.NLS.schroedingereq-Tuple{Function, Any, Any}" href="#Main.NLS.schroedingereq-Tuple{Function, Any, Any}"><code>Main.NLS.schroedingereq</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">schroedingereq(init_val::Function, dx::Real, dt::Real; lambda::Real = -2, epsilon::Real = 1e-7, T::Real = 6.0) -&gt; Matrix{ComplexF64}</code></pre><p>Solve the <strong>non-linear Schrödinger equation</strong> using the finite-difference method described in  <em>&quot;Finite-Difference Solutions of a Non-linear Schrödinger Equation&quot;</em> by Delfour, Fortin, and Payre (1981) [1].</p><p>This function implements a <strong>Crank-Nicolson time-stepping scheme</strong> combined with a fixed-point iteration  to handle the non-linearity in the Schrödinger equation.</p><p><strong>Mathematical Context</strong></p><p>The Schrödinger equation with non-linearity can be written as:</p><p class="math-container">\[i u_t + u_{xx} + \lambda |u|^2 u = 0\]</p><p>with </p><ul><li><code>u</code> as the function to solve</li><li><code>i</code> the imaginary unit with <code>i^2 = -1</code></li><li><code>x</code> as the spatial variable</li><li><code>t</code> as the time variable</li><li><code>\lambda</code> as an equation parameter</li></ul><p>The function discretizes the spatial domain with a step size dx and the time      domain with a step size dt. It uses a fixed-point iteration to approximate     the non-linear term at each time step.</p><p>The spatial domain is fixed with the interval (-30, 30).</p><p><strong>Arguments</strong></p><ul><li><code>init_val : Function</code> : Function which computes the initial values</li><li><code>dx : Real</code> : mesh size in the spatial variable</li><li><code>dt : Real</code> : time step size</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>lambda : Real</code> Parameter of the NLS-Equation, default = -2.0</li><li><code>epsilon : Real</code> Error threshold for the fix point iteration, default = 1e-7</li><li><code>T : Real</code> Total simulation time, default = 6.0</li></ul><p><strong>Returns</strong></p><p><code>U : Matrix{ComplexF64}</code> : The rows correspond to the spatial value and the columns correspond to the time values</p><p><strong>References# References</strong></p><p>[1] M. Delfour, M. Fortin, G. Payre: Finite Difference Solutions of a Non-linear Schrödinger equation. Journal of Computational Physics 44, 277-288 (1981)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NiclRich/NumPrak/blob/57af75da57fda2b621f1c571d4b3d92c5e4bd305/src/NLS_module.jl#L9-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Main.NLS.second_conservation-Tuple{Matrix{ComplexF64}, Real, Real}" href="#Main.NLS.second_conservation-Tuple{Matrix{ComplexF64}, Real, Real}"><code>Main.NLS.second_conservation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">second_conservation(U::AbstractMatrix{&lt;:Complex}, dx::Real; lambda::Real = -2)</code></pre><p>Compute the second conserved quantity for a numerical solution of the NLS-equation. The second conserved quantity is given by:</p><p class="math-container">\[\int \frac{1}{2} |u&#39;|^2 + \frac{\lambda}{4}|u|^4 \; dx\]</p><p><strong>Description</strong></p><p>This function calculates the <strong>second integral</strong>, which typically corresponds to the energy-like conservation quantity in numerical schemes, assuming that:</p><ul><li>Rows of <code>U</code> represent the spatial variable.</li><li>Columns of <code>U</code> represent the temporal variable.</li></ul><p>The function ensures the spatial step size <code>dx</code> is positive. It computes:</p><ol><li>The <strong>second integral</strong> as a discrete analogue of the integral.</li><li>The <strong>maximum</strong> and <strong>minimum</strong> values of the integral across the temporal domain.</li><li>The <strong>dissipation</strong>, defined as the difference between the maximum and minimum values.</li></ol><p><strong>Arguments</strong></p><ul><li><code>U::AbstractMatrix{&lt;:Complex}</code>: A complex-valued matrix where rows represent spatial variables and columns represent temporal variables.</li><li><code>dx::Real</code>: The spatial step size. Must be a positive real number.</li><li><code>lambda::Real</code> : Parameter of the NLS</li></ul><p><strong>Returns</strong></p><p>A tuple with the following values:</p><ul><li><code>second_integral::Vector{Float64}</code>: The computed second integral for each time step.</li><li><code>maximal_value::Float64</code>: The maximum value of the second integral.</li><li><code>minimal_value::Float64</code>: The minimum value of the second integral.</li><li><code>dissipation::Float64</code>: The difference between the maximum and minimum values (indicating dissipation).</li></ul><p><strong>Errors</strong></p><ul><li>Throws an <code>ErrorException</code> if <code>dx</code> is not a positive real number.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Example usage
U = rand(ComplexF64, 100, 10)  # Random complex-valued matrix with 100 spatial points and 10 time steps
dx = 0.1                      # Spatial step size

second_integral, max_val, min_val, dissipation = second_conservation(U, dx)

println(&quot;Second integral: &quot;, second_integral)
println(&quot;Maximum value: &quot;, max_val)
println(&quot;Minimum value: &quot;, min_val)
println(&quot;Dissipation: &quot;, dissipation)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NiclRich/NumPrak/blob/57af75da57fda2b621f1c571d4b3d92c5e4bd305/src/NLS_module.jl#L170-L217">source</a></section></article><p>Der Code kann ausgeführt werden, indem die Datei <code>NLS.jl</code> im Ordner <code>src</code> ausgeführt wird.</p><h2 id="Ergebnisse"><a class="docs-heading-anchor" href="#Ergebnisse">Ergebnisse</a><a id="Ergebnisse-1"></a><a class="docs-heading-anchor-permalink" href="#Ergebnisse" title="Permalink"></a></h2><p>Das Finite Differenzen Schema aus [1] erhält die beiden oben genannten Größen, während das explizite Finite Differenzen Schema diese nicht erhält. Weiterhin konnte beobachtet werden, dass das explizite Verfahren sehr instabil ist und nur für sehr kleine Gitterweiten und noch kleinere Zeitschritte plausible Werte liefert. Das explizite Verfahren erhält auch keine der beiden Erhaltungsgrößen.</p><p>Auch kann mit numerischen Experimenten nur eine Konvergenz der Differenz der Normen beobachtet werden, während Norm der Differenz recht hoch ist und das Verfahren gegen eine andere Lösung konvergiert als die Testlösung. Im Paper [1] wird die Konvergenz behauptet, aber nicht bewiesen.</p><p>Wir sehen auch, dass eine geringer Fehlertoleranz bei der Fixpunktiteration einen besseren Werten der Erhaltungssätze führt.</p><h2 id="Visualisierung"><a class="docs-heading-anchor" href="#Visualisierung">Visualisierung</a><a id="Visualisierung-1"></a><a class="docs-heading-anchor-permalink" href="#Visualisierung" title="Permalink"></a></h2><p><img src="gifs/NLS_abs.gif" alt="Absolutwerte der Lösungen"/> <img src="gifs/NLS_real.gif" alt="Realwerte der Lösungen"/> <img src="gifs/NLS_imag.gif" alt="Imaginärwerte der Lösungen"/> <img src="gifs/eps-diss.png" alt="Energiedissipation in Abhängigkeit von Epsilon"/></p><h2 id="Transparenz-Hinweis-KI"><a class="docs-heading-anchor" href="#Transparenz-Hinweis-KI">Transparenz-Hinweis KI</a><a id="Transparenz-Hinweis-KI-1"></a><a class="docs-heading-anchor-permalink" href="#Transparenz-Hinweis-KI" title="Permalink"></a></h2><p>Der Code für die NLS-Gleichung wurde ohne Zurhilfenahme von KI erstellt. Die Dokumentation des Codes und das Bash-Skript zur Ausführung wurden mit Hilfe von ChatGPT erstellt und menschlich nochmal geprüft und ggf. angepasst.</p><h2 id="Referenzen"><a class="docs-heading-anchor" href="#Referenzen">Referenzen</a><a id="Referenzen-1"></a><a class="docs-heading-anchor-permalink" href="#Referenzen" title="Permalink"></a></h2><p>[1] M. Delfour, M. Fortin, G. Payre: Finite Difference Solutions of a Non-linear Schrödinger equation. Journal of Computational Physics 44, 277-288 (1981) <a href="https://www.sciencedirect.com/science/article/abs/pii/0021999181900528">Journal</a></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 27 January 2025 17:14">Monday 27 January 2025</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
